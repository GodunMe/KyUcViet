<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Check-in - Vietnamese Memories</title>
  <link rel="icon" type="image/png" href="logo.PNG" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <!-- User Header -->
    <div class="user-header">
      <div class="user-info" onclick="toggleUserBox()">
        <img src="avatar/default.png" alt="User" class="user-icon">
        <span class="user-name">Nguyen Van A</span>
      </div>
      <div class="user-box" id="userBox">
        <button onclick="editProfile()">Chỉnh sửa thông tin</button>
        <button onclick="logout()">Logout</button>
      </div>
    </div>

    <!-- Page Header -->
    <div class="page-header">
      <h1>📍 Check-in</h1>
      <p>Quét QR code hoặc nhập mã để check-in tại bảo tàng</p>
    </div>

    <!-- QR Scanner Section -->
    <div class="checkin-section">
      <div class="qr-scanner">
        <div id="qr-reader" style="width: 100%;"></div>
      </div>
      
      <div class="or-divider">
        <span>HOẶC</span>
      </div>

      <!-- Manual Code Input -->
      <div class="manual-input">
        <h3>Nhập mã check-in</h3>
        <input type="text" id="checkinCode" placeholder="Nhập mã check-in..." maxlength="10">
        <button onclick="submitCheckin()" class="checkin-btn">Check-in</button>
      </div>
    </div>

    <!-- Recent Check-ins -->
    <div class="recent-checkins">
      <h3>Check-in gần đây</h3>
      <div id="recentList" class="checkin-history">
        <div class="checkin-item">
          <div class="checkin-info">
            <h4>Bảo tàng Hồ Chí Minh</h4>
            <p class="checkin-time">Hôm nay, 14:30</p>
            <p class="checkin-points">+25 điểm</p>
          </div>
          <div class="checkin-status">✓</div>
        </div>
        <div class="checkin-item">
          <div class="checkin-info">
            <h4>Bảo tàng Lịch sử Quân sự</h4>
            <p class="checkin-time">Hôm qua, 10:15</p>
            <p class="checkin-points">+30 điểm</p>
          </div>
          <div class="checkin-status">✓</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <div class="nav-item" onclick="navigateToPage('home')">
      <div class="nav-icon">🏠</div>
      <div class="nav-label">Home</div>
    </div>
    <div class="nav-item" onclick="navigateToPage('map')">
      <div class="nav-icon">🗺️</div>
      <div class="nav-label">Map</div>
    </div>
    <div class="nav-item active" onclick="navigateToPage('checkin')">
      <div class="nav-icon">📍</div>
      <div class="nav-label">Check-in</div>
    </div>
    <div class="nav-item" onclick="navigateToPage('leaderboard')">
      <div class="nav-icon">🏆</div>
      <div class="nav-label">Bảng xếp hạng</div>
    </div>
    <div class="nav-item" onclick="navigateToPage('profile')">
      <div class="nav-icon">👤</div>
      <div class="nav-label">Profile</div>
    </div>
  </div>

  <script>
    // Navigation functions
    function toggleUserBox() {
      const box = document.getElementById('userBox');
      box.classList.toggle('active');
    }

    function editProfile() {
      window.location.href = '/editProfile.html';
    }

    function logout() {
      window.location.href = '/login.php?token=1';
    }

    function navigateToPage(page) {
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      
      event.target.closest('.nav-item').classList.add('active');
      
      switch(page) {
        case 'home':
          window.location.href = '/index.php';
          break;
        case 'map':
          window.location.href = '/map.html';
          break;
        case 'checkin':
          // Already on checkin page
          break;
        case 'leaderboard':
          window.location.href = '/leaderboard.html';
          break;
        case 'profile':
          window.location.href = '/profile.html';
          break;
      }
    }

    // Check-in functions
    function submitCheckin() {
      const code = document.getElementById('checkinCode').value.trim();
      if (!code) {
        alert('Vui lòng nhập mã check-in!');
        return;
      }
      
      // Simulate API call
      if (code.length >= 4) {
        alert('Check-in thành công! +20 điểm');
        document.getElementById('checkinCode').value = '';
        // Refresh recent check-ins list
        loadRecentCheckins();
      } else {
        alert('Mã check-in không hợp lệ!');
      }
    }

    function loadRecentCheckins() {
      // This would normally fetch from API
      console.log('Loading recent check-ins...');
    }

    // Initialize QR Scanner (placeholder)
    function initQRScanner() {
      const qrReader = document.getElementById('qr-reader');
      qrReader.innerHTML = `
        <div style="height: 200px; display: flex; align-items: center; justify-content: center; background: #f0f0f0; border-radius: 8px; color: #666;">
          <div style="text-align: center;">
            <div style="font-size: 24px; margin-bottom: 10px;">📷</div>
            <div>Camera sẽ mở để quét QR code</div>
            <div style="font-size: 12px; margin-top: 5px;">(Chức năng đang phát triển)</div>
          </div>
        </div>
      `;
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      initQRScanner();
    });
  </script>
</body>
</html>