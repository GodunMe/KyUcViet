<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Báº£ng xáº¿p háº¡ng - Vietnamese Memories</title>
  <link rel="icon" type="image/png" href="logo.PNG" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <!-- User Header -->
    <div class="user-header" id="userHeader">
      <!-- User logged in state -->
      <div id="userLoggedIn" class="user-logged-in" style="display: none;">
        <div class="user-info">
          <img id="userAvatar" src="avatar/default.png" alt="User" class="user-icon">
          <span id="userName" class="user-name">Loading...</span>
        </div>
        <div class="user-points">
          <span id="userPoints">0Ä‘</span>
        </div>
      </div>
      
      <!-- User not logged in state -->
      <div id="usernotLoggedIn" class="user-not-logged-in" style="display: none;">
        <div class="login-prompt">
          <span class="login-text">ÄÄƒng nháº­p Ä‘á»ƒ xem báº£ng xáº¿p háº¡ng</span>
        </div>
        <button class="login-btn" onclick="goToLogin()">
          ğŸ”‘ ÄÄƒng nháº­p
        </button>
      </div>
    </div>

    <!-- Page Header -->
    <div class="page-header">
      <h1>ğŸ† Báº£ng xáº¿p háº¡ng</h1>
      <p>Xem thá»© háº¡ng cá»§a báº¡n vÃ  cáº¡nh tranh vá»›i nhá»¯ng ngÆ°á»i khÃ¡m phÃ¡ khÃ¡c</p>
    </div>

    <!-- User Rank Card -->
    <div class="user-rank-card">
      <div class="rank-badge">#7</div>
      <div class="user-info-rank">
        <img src="avatar/default.png" alt="User" class="rank-avatar">
        <div>
          <h3>Nguyen Van A</h3>
          <p>189 Ä‘iá»ƒm â€¢ 8 check-ins</p>
        </div>
      </div>
      <div class="rank-progress">
        <div class="progress-bar">
          <div class="progress-fill" style="width: 65%;"></div>
        </div>
        <p>CÃ²n 61 Ä‘iá»ƒm Ä‘á»ƒ lÃªn háº¡ng 6</p>
      </div>
    </div>

    <!-- Filter Tabs -->
    <div class="filter-tabs">
      <button class="tab-btn active" onclick="switchTab('all')">Táº¥t cáº£</button>
      <button class="tab-btn" onclick="switchTab('friends')">Báº¡n bÃ¨</button>
      <button class="tab-btn" onclick="switchTab('week')">Tuáº§n nÃ y</button>
    </div>

    <!-- Leaderboard List -->
    <div class="leaderboard-section">
      <div id="leaderboardList" class="leaderboard-list">
        <!-- Top 3 Podium -->
        <div class="podium">
          <div class="podium-item second">
            <div class="podium-avatar">
              <img src="avatar/default.png" alt="User 2">
              <div class="rank-number">2</div>
            </div>
            <h4>Tráº§n Thá»‹ B</h4>
            <p>298 Ä‘iá»ƒm</p>
          </div>
          <div class="podium-item first">
            <div class="podium-avatar">
              <img src="avatar/default.png" alt="User 1">
              <div class="rank-number crown">ğŸ‘‘</div>
            </div>
            <h4>LÃª VÄƒn C</h4>
            <p>342 Ä‘iá»ƒm</p>
          </div>
          <div class="podium-item third">
            <div class="podium-avatar">
              <img src="avatar/default.png" alt="User 3">
              <div class="rank-number">3</div>
            </div>
            <h4>Pháº¡m Minh D</h4>
            <p>276 Ä‘iá»ƒm</p>
          </div>
        </div>

        <!-- Regular Rankings -->
        <div class="ranking-list">
          <div class="ranking-item">
            <div class="rank-number">4</div>
            <img src="avatar/default.png" alt="User" class="rank-avatar">
            <div class="rank-info">
              <h4>HoÃ ng Thá»‹ E</h4>
              <p>245 Ä‘iá»ƒm â€¢ 12 check-ins</p>
            </div>
            <div class="rank-badge trending-up">ğŸ“ˆ</div>
          </div>
          <div class="ranking-item">
            <div class="rank-number">5</div>
            <img src="avatar/default.png" alt="User" class="rank-avatar">
            <div class="rank-info">
              <h4>Nguyá»…n VÄƒn F</h4>
              <p>223 Ä‘iá»ƒm â€¢ 9 check-ins</p>
            </div>
            <div class="rank-badge">-</div>
          </div>
          <div class="ranking-item">
            <div class="rank-number">6</div>
            <img src="avatar/default.png" alt="User" class="rank-avatar">
            <div class="rank-info">
              <h4>LÃ½ Thá»‹ G</h4>
              <p>201 Ä‘iá»ƒm â€¢ 11 check-ins</p>
            </div>
            <div class="rank-badge trending-down">ğŸ“‰</div>
          </div>
          <div class="ranking-item current-user">
            <div class="rank-number highlight">7</div>
            <img src="avatar/default.png" alt="User" class="rank-avatar">
            <div class="rank-info">
              <h4>Nguyen Van A (Báº¡n)</h4>
              <p>189 Ä‘iá»ƒm â€¢ 8 check-ins</p>
            </div>
            <div class="rank-badge">-</div>
          </div>
          <div class="ranking-item">
            <div class="rank-number">8</div>
            <img src="avatar/default.png" alt="User" class="rank-avatar">
            <div class="rank-info">
              <h4>Äáº·ng VÄƒn H</h4>
              <p>165 Ä‘iá»ƒm â€¢ 7 check-ins</p>
            </div>
            <div class="rank-badge trending-up">ğŸ“ˆ</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <div class="nav-item" onclick="navigateToPage('home')">
      <div class="nav-icon">ğŸ </div>
      <div class="nav-label">Home</div>
    </div>
    <div class="nav-item" onclick="navigateToPage('map')">
      <div class="nav-icon">ğŸ—ºï¸</div>
      <div class="nav-label">Map</div>
    </div>
    <div class="nav-item" onclick="navigateToPage('checkin')">
      <div class="nav-icon">ğŸ“</div>
      <div class="nav-label">Check-in</div>
    </div>
    <div class="nav-item active" onclick="navigateToPage('leaderboard')">
      <div class="nav-icon">ğŸ†</div>
      <div class="nav-label">Báº£ng xáº¿p háº¡ng</div>
    </div>
    <div class="nav-item" onclick="navigateToPage('profile')">
      <div class="nav-icon">ğŸ‘¤</div>
      <div class="nav-label">Profile</div>
    </div>
  </div>

  <script>
    // Load user info on page load
    async function loadUserInfo() {
      try {
        const response = await fetch('getUserInfo.php');
        if (response.ok) {
          const data = await response.json();
          
          if (data.loggedIn) {
            showUserLoggedInState(data);
          } else {
            showUserNotLoggedInState();
          }
        } else {
          showUserNotLoggedInState();
        }
      } catch (error) {
        console.error('Error loading user info:', error);
        showUserNotLoggedInState();
      }
    }

    function showUserLoggedInState(userData) {
      const loggedInDiv = document.getElementById('userLoggedIn');
      const notLoggedInDiv = document.getElementById('usernotLoggedIn');
      
      // Show logged in state, hide not logged in state
      loggedInDiv.style.display = 'flex';
      notLoggedInDiv.style.display = 'none';
      
      // Update user avatar
      const avatarElement = document.getElementById('userAvatar');
      avatarElement.src = userData.avatarRelative || 'avatar/default.png';
      
      // Update user name
      const nameElement = document.getElementById('userName');
      nameElement.textContent = userData.username || 'Guest User';
      
      // Update user points
      const pointsElement = document.getElementById('userPoints');
      pointsElement.textContent = (userData.score || 0) + 'Ä‘';
    }

    function showUserNotLoggedInState() {
      const loggedInDiv = document.getElementById('userLoggedIn');
      const notLoggedInDiv = document.getElementById('usernotLoggedIn');
      
      // Show not logged in state, hide logged in state
      loggedInDiv.style.display = 'none';
      notLoggedInDiv.style.display = 'flex';
    }

    function goToLogin() {
      // Redirect to login page
      window.location.href = 'login.php?token=1';
    }

    function navigateToPage(page) {
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      
      event.target.closest('.nav-item').classList.add('active');
      
      switch(page) {
        case 'home':
          window.location.href = '/index.php';
          break;
        case 'map':
          window.location.href = '/map.html';
          break;
        case 'checkin':
          window.location.href = '/checkin/checkin.html';
          break;
        case 'leaderboard':
          // Already on leaderboard page
          break;
        case 'profile':
          window.location.href = '/profile.html';
          break;
      }
    }

    // Tab switching
    function switchTab(tab) {
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      event.target.classList.add('active');
      
      // Here you would normally load different data based on the tab
      console.log('Switched to tab:', tab);
    }

    // Load leaderboard data
    function loadLeaderboard() {
      // This would normally fetch from API
      console.log('Loading leaderboard data...');
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      loadUserInfo();
      loadLeaderboard();
    });
  </script>
</body>
</html>